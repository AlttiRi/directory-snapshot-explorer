import{r as e,c as t,w as n,m as s,i as a,t as l,u as o,p as r,a as i,o as c,b as u,d,e as p,f as v,g as f,h,n as m,j as y,k as g,F as k,l as b,q as w,s as D,v as _,x as E,y as x,z as j,A as T,B as $}from"./vendor.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const C=globalThis.setImmediate||function(){const{port1:e,port2:t}=new MessageChannel,n=[];return e.onmessage=function(){n.shift()()},function(e){t.postMessage(null),n.push(e)}}();function I(e){return new Promise(void 0===e?e=>C(e):t=>setTimeout(t,e))}const S=["mp4","webm","mkv","avi"];const M=["png","jpg","jpeg","gif","tiff","webp"];function N(e,t=!0){const n=new Date(e);function s(e){return e.toString().padStart(2,"0")}const a=t?"UTC":"",l=n[`get${a}FullYear`](),o=n[`get${a}Month`]()+1,r=n[`get${a}Date`]();return 0===Number(n)?(console.warn("date is 1970.01.01"),""):l+"."+s(o)+"."+s(r)}const L=e(!0),{compare:O}=new Intl.Collator(void 0,{numeric:!0,sensitivity:"accent"});function F(e,t){return L.value?O(e.name,t.name):0}const P=t((()=>pe.value.folders)),W=t((()=>pe.value.files)),B=t((()=>pe.value.symlinks)),U=t((()=>pe.value.fifos)),q=t((()=>pe.value.charDevs)),A=t((()=>pe.value.blockDevs)),J=t((()=>pe.value.sockets)),z=t((()=>[...P.value.sort(F),...W.value.sort(F),...B.value.sort(F),...U.value.sort(F),...q.value.sort(F),...A.value.sort(F),...J.value.sort(F)])),K=t((()=>ee.value.length?ne.value:z.value)),R=t((()=>K.value.slice(0,1e3))),V=t((()=>ne.value.length>1e3?ne.value.length:K.value.length)),Y=e("");function G(e){Y.value=e}function H(e){Y.value+=e}const Q=["folder","file","symlink","fifo","charDev","blockDev","socket"];class SimpleEntry{constructor({name:e,parent:t,type:n,meta:s,errors:a}){this.name=e,this.parent=t,this.type=n,s&&(this.meta=s),a&&(this.errors=a)}addChild(e){this.children||(this.children=[]),this.children.push(e)}get folders(){var e;return(null==(e=this.children)?void 0:e.filter((e=>"folder"===e.type)))||[]}get files(){var e;return(null==(e=this.children)?void 0:e.filter((e=>"file"===e.type)))||[]}get symlinks(){var e;return(null==(e=this.children)?void 0:e.filter((e=>"symlink"===e.type)))||[]}get fifos(){var e;return(null==(e=this.children)?void 0:e.filter((e=>"fifo"===e.type)))||[]}get charDevs(){var e;return(null==(e=this.children)?void 0:e.filter((e=>"charDev"===e.type)))||[]}get blockDevs(){var e;return(null==(e=this.children)?void 0:e.filter((e=>"blockDev"===e.type)))||[]}get sockets(){var e;return(null==(e=this.children)?void 0:e.filter((e=>"socket"===e.type)))||[]}get isEmpty(){var e;return!Boolean(null==(e=this.children)?void 0:e.length)}get hasErrors(){var e;return Boolean(null==(e=this.errors)?void 0:e.length)}get root(){return this.parent?this.parent.root:this}get path(){return this.parent?[...this.parent.path,this]:[this]}}function X(e,t=null){const n=new SimpleEntry({name:e.name,type:"folder",errors:e.errors,parent:t});e.folders&&e.folders.forEach((e=>{n.addChild(X(e,n))}));return["file","fifo","charDev","blockDev","socket"].forEach((t=>{e[t+"s"]&&e[t+"s"].forEach((e=>{n.addChild(new SimpleEntry({name:e,parent:n,type:t}))}))})),e.symlinks&&e.symlinks.forEach((e=>{if("string"==typeof e)return void n.addChild(new SimpleEntry({name:e,parent:n,type:"symlink"}));const t=e.pathTo?{pathTo:e.pathTo}:null;n.addChild(new SimpleEntry({name:e.name,parent:n,type:"symlink",meta:t,errors:e.errors}))})),n}const Z=new SimpleEntry({name:"",parent:null,type:"folder"}),ee=e("");function te(){ee.value=""}const ne=e([]);function se(e){ne.value=s(e),console.log("globalThis.search:",globalThis.search=e),Object.defineProperty(globalThis.search,"download",{get(){console.log("download")}})}const ae=function(e,t=50){let n;return function(){n&&clearTimeout(n),n=setTimeout((()=>{e.apply(this,arguments),n=null}),t)}}(le,300);async function le(){const e=pe.value,t=ee.value,n=a(e)?l(e):e,s=performance.now(),o=await async function(e,t){var n;if(!t.startsWith("/"))return oe(e,(e=>e.name.includes(t)));{const{type:s,word:a}=(null==(n=t.match(/\/type:(?<type>[^\/]+)\/?(?<word>[^\/]*)/))?void 0:n.groups)||{};if(s&&(console.log({type:s,word:a}),Q.includes(s)))return oe(e,(e=>e.type===s&&e.name.includes(a)))}return!1}(n,t);if(!o)return;G(`Search time: ${(performance.now()-s).toFixed(2)} ms; `),await I();const r=performance.now(),i=o.sort(F);H(`Sort time: ${(performance.now()-r).toFixed(2)} ms; `),await I(),se(i),H(`${o.length} items; search: ${t}`)}async function oe(e,t){let n=[],s=Date.now();for(const a of function*(e){const t=1e3;let n=[];function*s(e){for(const a of e.children||[])"folder"===a.type&&(yield*s(a)),n.push(a),n.length===t&&(yield n,n=[])}yield*s(e),yield n}(e)){const e=Date.now();e-s>15&&(s=e,await I());for(const s of a)t(s)&&n.push(s)}return n}n(ee,(async(e,t)=>{e?e.length-t.length>1?await le():await ae():se([])}));const re=e(null),ie=e(null);function ce(e){re.value=s(e.meta),console.time("parseEntries");const t=X(e);console.timeEnd("parseEntries"),ie.value=s(t),globalThis.json=t,fe(t),te()}const ue=t((()=>{var e;return(null==(e=re.value)?void 0:e.separator)||"/"})),de=t((()=>{var e;return(null==(e=re.value)?void 0:e.path)||[]})),pe=e(Z),ve=t((()=>pe.value.path));function fe(e){te(),pe.value=s(o(e))}const he=t((()=>ie.value&&pe.value.isEmpty));n(re,(async(e,t)=>{console.log("[meta]:",re.value);const{files:n,folders:s,symlinks:a,errors:l,total:o,scanDate:r}=re.value;re.value.scanDate&&G(`files: "${n}" folders: "${s}", symlinks: "${a}", errors: "${l}", total: "${o}", scanDate: "${N(r)}"`)}));r("data-v-06f0cfae");const me={class:"scanPath"},ye=["title"],ge={class:"part"},ke={class:"part spaced"},be={key:0,class:"spaced separator"};i();const we={setup(e){const n=t((()=>{if(!re.value)return;const{files:e,folders:t,symlinks:n,charDevs:s,blockDevs:a,fifos:l,sockets:o,total:r,platform:i,scanDate:c}=re.value;function u(e){return Object.entries(e).map((([e,t])=>function(e){const t=3-Math.trunc(e.length/4);return console.log(e,t),e+"\t".repeat(t)}(e)+": "+t)).join("\n")}const d=u({files:e,folders:t,symlinks:n}),p=u({charDevs:s,blockDevs:a,fifos:l,sockets:o}),v=u({total:r,platform:i,scanDate:N(c)});let f;return f="win32"!==i?[d,p,v].join("\n"):[d,v].join("\n"),console.log(f),f})),s=t((()=>{const e=[...de.value,pe.value.root.name].join(ue.value);return e.startsWith("//")?e.slice(1):e})),a=t((()=>[...s.value].slice(0,-1).join(""))),l=t((()=>[...s.value].slice(-1).join(""))),r=t((()=>ve.value.length-1&&"/"!==s.value));function i(){fe(pe.value.root)}return(e,t)=>(c(),u("span",me,[d("span",{class:"parts",onClick:i,title:o(n)},[d("span",ge,p(o(a)),1),d("span",ke,p(o(l)),1)],8,ye),o(r)?(c(),u("span",be,p(o(ue)),1)):v("",!0)]))},__scopeId:"data-v-06f0cfae"};r("data-v-44b3de2e");const De={class:"opened-folder"},_e={class:"part"},Ee={class:"part spaced"},xe={key:0,class:"separator spaced"};i();const je={props:["index","count","entry"],setup(e){const n=e,{index:s,count:a,entry:l}=f(n),r=t((()=>s.value+1===a.value)),i=t((()=>[...l.value.name].slice(0,-1).join(""))),h=t((()=>[...l.value.name].slice(-1).join("")));function m(){fe(l.value)}return(e,t)=>(c(),u("span",De,[d("span",{class:"parts",onClick:m},[d("span",_e,p(o(i)),1),d("span",Ee,p(o(h)),1)]),o(r)?v("",!0):(c(),u("span",xe,p(o(ue)),1))]))},__scopeId:"data-v-44b3de2e"};r("data-v-f8be0ec4");const Te={class:"box"};i();const $e={props:{maxWidth:{default:"max-content",type:String}},setup:e=>(t,n)=>(c(),u("div",Te,[d("div",{class:"sub",style:m({maxWidth:e.maxWidth})},[h(t.$slots,"default",{},void 0,!0)],4)])),__scopeId:"data-v-f8be0ec4"};r("data-v-55c28eea");const Ce={class:"address"};i();const Ie={setup:e=>(e,t)=>(c(),u("div",Ce,[y($e,null,{default:g((()=>[y(we)])),_:1}),(c(!0),u(k,null,b(o(ve).slice(1),((e,t)=>(c(),w($e,null,{default:g((()=>[y(je,{entry:e,index:t,count:o(ve).slice(1).length},null,8,["entry","index","count"])])),_:2},1024)))),256))])),__scopeId:"data-v-55c28eea"};r("data-v-a5a6c16c");const Se={class:"search"};i();const Me={setup:e=>(e,t)=>(c(),u("div",Se,[D(d("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>E(ee)?ee.value=e:null)},null,512),[[_,o(ee)]]),d("button",{onClick:t[1]||(t[1]=(...e)=>o(te)&&o(te)(...e))},"Clear")])),__scopeId:"data-v-a5a6c16c"};r("data-v-31779169");const Ne={class:"file-select"},Le=x(" Select file "),Oe=d("hr",null,null,-1);i();const Fe={setup(e){async function t(e){ce(JSON.parse(await e.target.files[0].text()))}return(e,n)=>(c(),u("div",Ne,[d("label",null,[Le,d("input",{type:"file",accept:"application/json",onChange:t},null,32)]),Oe]))},__scopeId:"data-v-31779169"};r("data-v-1717d4e8");const Pe={class:"tabs"},We=d("div",{class:"tab"},"Tab 1",-1);i();const Be={setup:e=>(e,t)=>(c(),u("div",Pe,[y(Fe,{class:"tab"}),We])),__scopeId:"data-v-1717d4e8"};r("data-v-42fb68fc");const Ue=["title"],qe={class:"icon"},Ae={class:"name"};i();const Je={props:["entry"],setup(e){const n=f(e).entry,s=t((()=>n.value.hasErrors)),a=t((()=>{var e;return n.value.hasErrors?JSON.stringify(n.value.errors[0],null," "):"symlink"===n.value.type?null==(e=n.value.meta)?void 0:e.pathTo:void 0})),l=t((()=>"folder"===n.value.type?"📁":"file"===n.value.type?function(e){const{ext:t}=e.match(/(?<ext>[^\.]+)$/).groups;return S.includes(t)}(n.value.name)?"🎦":function(e){const{ext:t}=e.match(/(?<ext>[^\.]+)$/).groups;return M.includes(t)}(n.value.name)?"🖼":"📄":"symlink"===n.value.type?"🔗":"👾"));function r(e){"folder"===n.value.type?(console.log("openFolder",n.value),fe(n.value)):console.log(n.value)}function i(e){1===e.button&&"folder"===n.value.type&&console.log("MIDDLE_BUTTON on a folder",e)}return(e,t)=>(c(),u("tr",{class:j(["row",{error:o(s)}]),onClick:r,onMousedown:i,title:o(a)},[d("td",qe,p(o(l)),1),d("td",Ae,p(o(n).name),1)],42,Ue))},__scopeId:"data-v-42fb68fc"};r("data-v-47520d98");const ze={key:0,class:"rows"},Ke={key:1,class:"empty-message"},Re=[d("span",null,"The folder is empty.",-1)],Ve={key:2,class:"error-message"},Ye=d("h2",null,"Error",-1),Ge=d("td",null,"syscall",-1),He=d("td",null,"code",-1),Qe=d("td",null,"errno",-1);i();const Xe={setup(e){const n=t((()=>!!pe.value.hasErrors&&pe.value.errors[0]));function s(e){e.preventDefault(),pe.value.parent&&fe(pe.value.parent)}return(e,t)=>(c(),u("div",{class:"content",onContextmenu:s},[o(R).length?(c(),u("table",ze,[(c(!0),u(k,null,b(o(R),(e=>(c(),w(Je,{entry:e},null,8,["entry"])))),256))])):v("",!0),o(he)&&!o(n)?(c(),u("div",Ke,Re)):v("",!0),o(n)?(c(),u("div",Ve,[d("div",null,[Ye,d("table",null,[d("tr",null,[Ge,d("td",null,[d("pre",null,p(o(n).syscall),1)])]),d("tr",null,[He,d("td",null,[d("pre",null,p(o(n).code),1)])]),d("tr",null,[Qe,d("td",null,[d("pre",null,p(o(n).errno),1)])])])])])):v("",!0)],32))},__scopeId:"data-v-47520d98"},Ze={setup:e=>(e,t)=>(c(),u("div",null,"Item count: "+p(o(V)),1))},et={key:0},tt={key:1},nt={setup:e=>(e,t)=>o(Y)?(c(),u("span",et,p(o(Y)),1)):(c(),u("span",tt,"_"))};r("data-v-8225cb6e");const st={class:"main"},at=d("div",{style:{"grid-area":"switch"}},null,-1);i();const lt={setup:e=>(T((async()=>{const e=new URL(location.href).searchParams.get("filepath");if(e){const t=await fetch(e);ce(await t.json())}})),(e,t)=>(c(),u("div",st,[at,y(Ie,{style:{"grid-area":"address"}}),y(Me,{style:{"grid-area":"search"}}),y(Be,{style:{"grid-area":"tabs"}}),y(Xe,{style:{"grid-area":"content"}}),y(Ze,{style:{"grid-area":"status"}}),y(nt,{style:{"grid-area":"debug"}})]))),__scopeId:"data-v-8225cb6e"};$({setup:e=>(e,t)=>(c(),w(lt))}).mount("#app");
//# sourceMappingURL=index.js.map
