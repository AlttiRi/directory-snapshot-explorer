var e,t=Object.defineProperty,__publicField=(e,a,n)=>(((e,a,n)=>{a in e?t(e,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[a]=n})(e,"symbol"!=typeof a?a+"":a,n),n);import{r as a,c as n,i as s,t as r,w as o,a as l,s as i,b as c,d as u,e as d,f as p,o as f,g as h,h as v,j as m,u as g,k as y,l as b,m as w,n as S,p as _,q as k,F as D,v as z,x as T,y as E,z as M,A as C,B as x,C as I,D as P,E as j,G as $,H as F,I as L,J as W,K as B,T as H,L as R,M as N,N as O,O as A,P as Y}from"./vendor.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))processPreload(e);new MutationObserver((e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&processPreload(e)})).observe(document,{childList:!0,subtree:!0})}function processPreload(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const U=globalThis.setImmediate||function(){const{port1:e,port2:t}=new MessageChannel,a=[];return e.onmessage=function(){a.shift()()},function(e){t.postMessage(null),a.push(e)}}();function sleep(e){return new Promise(void 0===e?e=>U(e):t=>setTimeout(t,e))}const q=["mp4","webm","mkv","avi","mov","m4v","m4v","mpg","mpeg","wmv","flv"];const Z=["jpg","png","jpeg","gif","webp","jfif","jpe","tiff"];const G=["mp3","flac","wav","wma","aac"];async function*iterateAsyncDataSource(e){if(e instanceof Response&&(e=e.body),e instanceof ReadableStream)yield*async function*(e){const t=e.getReader();for(;;){const{done:e,value:a}=await t.read();if(e)break;yield a}}(e);else if(e instanceof Blob)for(const t of function*(e,t=2097152){let a=0;for(;;){const n=e.slice(a,a+t);if(!n.size)break;yield read(n),a+=t}async function read(e){return new Uint8Array(await e.arrayBuffer())}}(e))yield await t}function tripleSizeGroups(e){const t=e.toString();return t.padStart(t.length+(3-t.length%3)).match(/(.{3})/g).join(" ").trimStart()}function bytesToSize(e,t=2){if(0===e)return"0 B";t=t<0?0:t;const a=Math.floor(Math.log(e)/Math.log(1024));return Number.parseFloat((e/Math.pow(1024,a)).toFixed(t))+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][a]}function bytesToSizeWinLike(e){if(e<1024)return e+" B";let t=Math.floor(Math.log(e)/Math.log(1024)),a=e/Math.pow(1024,t);return a>=1e3&&(t++,a/=1024),function(e){let t;e<10?t=Math.trunc(100*e)/100:e<100?t=Math.trunc(10*e)/10:e<1e3&&(t=Math.trunc(e));if(e<.1)return t.toPrecision(1);if(e<1)return t.toPrecision(2);return t.toPrecision(3)}(a)+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][t]}function blue(e){return[`%c${e}`,"color: #2196f3; font-weight: bold;"]}function dateToDayDateString(e,t=!0){return formatDate(e,"YYYY.MM.DD",t)}function dateToDayDateTimeString(e,t=!0){return formatDate(e,"YYYY.MM.DD HH:mm:SS",t)+(t?"Z":"")}function formatDate(e=new Date,t="YYYY.MM.DD",a=!0){function pad0(e,t=2){return e.toString().padStart(t,"0")}var n,s;e="string"==typeof(s=n=e)||s instanceof String?n.replace(/(?<y>\d{4})\.(?<m>\d{2})\.(?<d>\d{2})/,"$<y>-$<m>-$<d>"):n;const r=new Date(e);"Invalid Date"===r.toString()&&console.warn("Invalid Date value: ",e);const o=new class{constructor(e=new Date,t=!0){this.date=e,this.utc=t?"UTC":""}get SS(){return pad0(this.date[`get${this.utc}Seconds`]())}get mm(){return pad0(this.date[`get${this.utc}Minutes`]())}get HH(){return pad0(this.date[`get${this.utc}Hours`]())}get MM(){return pad0(this.date[`get${this.utc}Month`]()+1)}get DD(){return pad0(this.date[`get${this.utc}Date`]())}get YYYY(){return pad0(this.date[`get${this.utc}FullYear`](),4)}get YY(){return this.YYYY.slice(2)}}(r,a);return t.replaceAll(/YYYY|YY|MM|DD|HH|mm|SS/g,((...e)=>o[e[0]]))}const J=a(!0),K=a("mtime"),V=a("name"),X=a({name:!1,size:!1,time:!1}),Q=n((()=>X.value[V.value]));function toggleOrder(){X.value[V.value]=!X.value[V.value]}const{compare:ee}=new Intl.Collator(void 0,{numeric:!0,sensitivity:"accent"});function comparator(e,t){const a=Q.value?-1:1;if(J.value){if("name"===V.value)return ee(e.name,t.name)*a;if("size"===V.value)return(e.size-t.size)*a;if("time"===V.value){const n=K.value;return(e[n]-t[n])*a}}return 0}const te=n((()=>[...Le.value.folders.sort(comparator),...Le.value.files.sort(comparator),...Le.value.symlinks.sort(comparator),...Le.value.fifos.sort(comparator),...Le.value.charDevs.sort(comparator),...Le.value.blockDevs.sort(comparator),...Le.value.sockets.sort(comparator)])),ae=a(50),ne=n((()=>Se.value.length?_e.value:te.value)),se=n((()=>ne.value.slice(0,ae.value))),re=n((()=>_e.value.length>ae.value?_e.value.length:ne.value.length)),oe=a(null);Object.defineProperty(globalThis,"list",{get:()=>ne.value}),Object.defineProperty(globalThis,"names",{get:()=>ne.value.map((e=>e.name))});const le=a("");function addMessage(e){le.value=e}function appendMessage(e){le.value+=e}function debugMessageFromEntry(e){if(console.log(s(e)?"Proxy:":"Raw:",r(e)),e.hasErrors)le.value="";else{const t=e.name?'"'+e.name.slice(0,20)+(e.name.length<20?"":"…")+'"':"";let a=[];void 0!==e.mtime&&a.push(`mtime "${dateToDayDateTimeString(e.mtime,!1)}"`),void 0!==e.btime&&a.push(`btime "${dateToDayDateTimeString(e.btime,!1)}"`),a=[...a,t,`${tripleSizeGroups(e.size)} (${bytesToSizeWinLike(e.size)})`],le.value=a.filter((e=>e)).join(" — ")}}const ie=["folder","file","symlink","fifo","charDev","blockDev","socket"];class SimpleEntry{constructor(e,t,a){this.name=e.name,this.parent=t,this.type=e.type,e.size&&(this._size=e.size),e.mtime&&(this._mtime=e.mtime),e.btime&&(this.btime=e.btime),e.errors&&(this.errors=e.errors.map((e=>a.get(e)))),e.pathTo&&(this.pathTo=e.pathTo),e.content&&(this.content=e.content),null==t||t.addChild(this)}addChild(e){this.children||(this.children=[]),this.children.push(e),this.increaseContentSize(e.size)}addHardlinks(e,t){this.hardlinks=e,this.hardlinksTotal=t}addMeta(e){this.meta=e}increaseContentSize(e){e&&(this._contentSize||(this._contentSize=0),this._contentSize+=e,this.parent&&e&&this.parent.increaseContentSize(e))}get mtime(){if(void 0!==this._mtime)return this._mtime;if("folder"===this.type&&this.children){let e=Number.MIN_SAFE_INTEGER;for(const t of this.children)t.mtime>e&&(e=t.mtime);if(e!==Number.MIN_SAFE_INTEGER)return e}}get size(){return"folder"===this.type?this._contentSize||0:this._size||0}get folders(){var e;return(null==(e=this.children)?void 0:e.filter((e=>"folder"===e.type)))||[]}get files(){var e;return(null==(e=this.children)?void 0:e.filter((e=>"file"===e.type)))||[]}get symlinks(){var e;return(null==(e=this.children)?void 0:e.filter((e=>"symlink"===e.type)))||[]}get fifos(){var e;return(null==(e=this.children)?void 0:e.filter((e=>"fifo"===e.type)))||[]}get charDevs(){var e;return(null==(e=this.children)?void 0:e.filter((e=>"charDev"===e.type)))||[]}get blockDevs(){var e;return(null==(e=this.children)?void 0:e.filter((e=>"blockDev"===e.type)))||[]}get sockets(){var e;return(null==(e=this.children)?void 0:e.filter((e=>"socket"===e.type)))||[]}get isEmpty(){var e;return!Boolean(null==(e=this.children)?void 0:e.length)}get hasErrors(){var e;return Boolean(null==(e=this.errors)?void 0:e.length)}get root(){return this.parent?this.parent.root:this}get path(){return this.parent?[...this.parent.path,this]:[this]}get contentTypesStats(){return this.getContentTypesStats()}_getContentTypesStats(e=!0,t={},a=this){if("folder"===a.type&&a.children){for(const n of a.children)t[n.type]?t[n.type]++:t[n.type]=1,"folder"===n.type&&e&&this._getContentTypesStats(e,t,n);return t}}getContentTypesStats(e=!0){console.time("getContentTypesStats");const t=this._getContentTypesStats(e);return console.timeEnd("getContentTypesStats"),t}*[Symbol.iterator](){if(yield this,this.children)for(const e of this.children)yield*e}flat(){return[...this]}static flat(e){return e.map((e=>[...e])).flat()}get pathString(){return this.getPathString()}getPathString(e){const t=this.path.map((e=>e.name));let a;return a=(null==e?void 0:e.path)?[...e.path,...t].join(e.separator||"/"):t.join("/"),a.startsWith("//")?a.slice(1):a}}class EntryStreamParser{constructor(){this.rootId=0,this.map=new Map,this.hidMap=new Map}setMeta(e){this.meta=e;const t=e.errorsMap;t&&(this.errorsIDMap=new Map(Object.entries(t).map((([e,t])=>{const[a,n,s]=e.split(":");return[t,{code:a,syscall:n,errno:Number(s)}]}))))}parse(e){var t;let a=!1;for(const n of e){const e=null!=(t=this.map.get(n.pid))?t:null,s=new SimpleEntry(n,e,this.errorsIDMap);if("folder"===n.type&&this.map.set(n.id,s),n.hid){const e=this.hidMap.get(n.hid)||[];this.hidMap.set(n.hid,[...e,s])}n.pid===this.rootId&&(a=!0)}return{root:this.map.get(this.rootId),rootUpdated:a,processed:e.length}}processHIDMapAsync(){this.hidMap.size&&(console.log("[hidMap]:",this.hidMap),console.time("hidMap"),async function(e){let t=0,a=0;for(const[n,s]of e.entries()){if(!(t++%1e3)){const e=Date.now();e-a>15&&(a=e,await sleep())}const e=Number(n.split(":")[1]);s.forEach((t=>{t.addHardlinks(s,e)}))}}(this.hidMap).then((()=>console.timeEnd("hidMap"))))}}const ce=new SimpleEntry({type:"folder",name:"",pid:null},null);const ue="folder";class WebFileEntry{constructor({file:e,parent:t,type:a,name:n}){e&&(this.file=e),t&&(this.parent=t,t.addChild(this)),n&&(this._name=n),this.type=a}get nativePath(){var e;return null==(e=this.file)?void 0:e.path}get name(){var e;return this._name||(null==(e=this.file)?void 0:e.name)}addChild(e){this.children||(this.children=[]),this.children.push(e),this.increaseContentSize(e.size)}increaseContentSize(e){e&&(this._contentSize||(this._contentSize=0),this._contentSize+=e,this.parent&&this.parent.increaseContentSize(e))}get size(){var e;return"folder"===this.type?this._contentSize||0:(null==(e=this.file)?void 0:e.size)||0}get mtime(){var e;return(null==(e=this.file)?void 0:e.lastModified)||0}get path(){return this.parent?[...this.parent.path,this]:[this]}*[Symbol.iterator](){if(yield this,this.children)for(const e of this.children)yield*e}flat(){return[...this]}static flat(e){return e.map((e=>[...e])).flat()}static async fromDataTransfer(e,t){const a=[...e.items],n=[...e.files],s=await async function(e){const t=[];for(const a of e)t.push(await dtItemToFileSystemEntry(a));return t}(a);console.log("[fileSystemEntries]:",s);const r=[];for(const o of s)r.push(await fromFileSystemEntry(o,null,t,n.shift()));return r}static fromFiles(e,t="file"){const a=[];for(const n of e)a.push(new WebFileEntry({file:n,type:t}));return a}}async function fromFileSystemEntry(e,t=null,a=!1,n){if(!e.isFile){if(e.isDirectory&&a){const s=new WebFileEntry({type:"folder",parent:t,name:e.name,file:n}),r=async function*(e){const t=e.createReader();let a=[];do{a=await new Promise(((e,a)=>t.readEntries(e,a)));for(const e of a)yield e}while(a.length)}(e);for await(const e of r)await fromFileSystemEntry(e,s,a);return s}return new WebFileEntry({type:"folder",parent:t,name:e.name,file:n})}try{const a=await(s=e,new Promise(((e,t)=>s.file(e,t))));return new WebFileEntry({file:a,type:"file",parent:t})}catch(r){return console.error("[fromFileSystemEntry][error]",e.name,r),null}var s}async function dtItemToFileSystemEntry(e){return e.webkitGetAsEntry()}const de="undefined"!=typeof nw&&1===(null==(e=nw.process)?void 0:e.__nwjs);const pe=a(!1),fe=a(!0),he=a(0),ve=a(0),me=a(0),ge=a(!1),ye=a(!1),be=function({recursive:e}={recursive:!1}){const t=a([]),s=a([]),i=a(null),c=a(!1),u=a([]),d=a(null),p=a(!1),f=a(0),h=a([]),v=a(!1);o((async()=>{const a=Date.now();c.value=!0,d.value?(console.log("[fromDataTransferItems]"),t.value=await WebFileEntry.fromDataTransfer(d.value,e)):de&&v.value?(console.log("[isNwDirectory]"),t.value=WebFileEntry.fromFiles(s.value,ue)):(console.log("[fromFiles]"),t.value=WebFileEntry.fromFiles(s.value)),c.value=!1,console.log("[WebFileEntry parsing][time]:",Date.now()-a,"ms"),console.log("[fileEntries]",r(t.value))}));const m=n((()=>t.value[0])),g=n((()=>t.value.length));function setFiles(e,t=!0){const a=[...e];s.value=a,console.log("[setFiles]:",a),t&&(d.value=null,u.value=[])}return{fileEntries:l(t),clearInput:function(){i.value.value=null,s.value=[],d.value=null,u.value=[]},private:{dropHover:p,dropHoverItemCount:f,dropHoverTypes:h,fileEntries:t,parsing:c,file:m,count:g,setDataTransferHover:function(e){const t=e.items.length,a=[...e.items].map((e=>e.type)),n=[...new Set(a)];f.value=t,h.value=n,console.log("[setDataTransferHover]:",t,n)},resetDataTransferHover:function(){f.value=0,h.value=[]},setDataTransfer:function(e){console.log("setDataTransfer",e),setFiles(e.files,!1),function(e){const t=[...e];u.value=t,console.log("[_setDtItems]:",t),console.log("[_setDtItems][0]:",{kind:t[0].kind,type:t[0].type})}(e.items),d.value=e},setFiles:setFiles,isNwDirectory:v,inputElem:i}}}({recursive:!1}),we={},__vitePreload=function(e,t,a){if(!t||0===t.length)return e();const n=document.getElementsByTagName("link");return Promise.all(t.map((e=>{if(e=function(e,t){return new URL(e,t).href}(e,a),e in we)return;we[e]=!0;const t=e.endsWith(".css"),s=t?'[rel="stylesheet"]':"";if(!!a)for(let a=n.length-1;a>=0;a--){const s=n[a];if(s.href===e&&(!t||"stylesheet"===s.rel))return}else if(document.querySelector(`link[href="${e}"]${s}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":"modulepreload",t||(r.as="script",r.crossOrigin=""),r.href=e,document.head.appendChild(r),t?new Promise(((t,a)=>{r.addEventListener("load",t),r.addEventListener("error",(()=>a(new Error(`Unable to preload CSS for ${e}`))))})):void 0}))).then((()=>e()))};async function handleMegaUrl(e){let t;addMessage(e),globalThis.Mega=await __vitePreload((()=>import("https://alttiri.github.io/meganz-api/meganz-api.standalone.es.js")),[],import.meta.url);try{t=await globalThis.Mega.node(e)}catch(s){return void addMessage(s)}t=t.root,console.log(t);let a=parseMegaNode(t);a._url=e,console.log(a);const n={url:e,id:a._id,ownerId:a._ownerId,btime:a.btime&&dateToDayDateTimeString(a.btime),mtime:a.mtime&&dateToDayDateTimeString(a.mtime)};if("folder"!==a.type){const e=new SimpleEntry({type:"folder",name:"",pid:null},null);e.addChild(a),a=e}a.root.addMeta({special:n}),openFolder(a)}function parseMegaNode(e,t=null){const a=function(e,t){const a={name:null===(n=e).name?"[encrypted]":n.name,size:n.size,btime:1e3*n.creationDate,mtime:1e3*n.modificationDate,id:n.id,type:"rootFolder"===n.type||"folder"===n.type?"folder":"file",pid:n.parentId};var n;const s=new SimpleEntry(a,t);return s._id=e.id,s._ownerId=e.ownerId,s}(e,t);if("folder"===a.type)for(const n of[...e.folders,...e.files])parseMegaNode(n,a);return a}const Se=a("");function clearSearch(){console.log("[clearSearch]"),Se.value=""}const _e=i([]);function setSearchResult(e){const t=r(e);_e.value=t,ae.value=50,function(e){globalThis.search=e,console.log("globalThis.search:",e),Object.defineProperty(globalThis.search,"download",{get(){console.log("download")}}),Object.defineProperty(globalThis.search,"names",{get:()=>globalThis.search.map((e=>e.name))}),Object.defineProperty(globalThis.search,"namelist",{get:()=>globalThis.search.map((e=>e.name)).join("\n")})}(t)}function sortSearch(){const e=Date.now();_e.value.sort(comparator);const t=Date.now()-e;return console.log("[search][sort][time]",t,"ms"),u(_e),t}c([V,Q,K],(()=>{sortSearch()}));let resolve=()=>{},ke=Promise.resolve(!0);function simplify(e){return e.toLowerCase()}o((()=>{fe.value?resolve(!0):(resolve(!1),ke=new Promise((e=>resolve=e)))})),window.addEventListener("storage",(e=>{"search-sync"===e.key&&(document.querySelector("input").value=e.newValue,document.querySelector("input").dispatchEvent(new Event("input")))}));const De=function(e,t=50){let a;return function(){a&&clearTimeout(a),a=setTimeout((()=>{e.apply(this,arguments),a=null}),t)}}(performSearch,300);async function performSearch(){if(ge.value)return void console.log("[return][already searching]");const e=new URL(location.href).searchParams.get("searchSync");if(e&&(localStorage.setItem("search-sync",Se.value),document.title="Search..."),ge.value=!0,!1===await ke)return void console.log("[return][scan parsing completed]");console.log("[next][scan parsing completed]");const t=Le.value,a=Se.value;if(""===a)return ge.value=!1,void(ye.value=!1);const n=d(t)?r(t):t,s=performance.now(),{result:o,search:l}=await async function(e,t){var a,n,s,r;let o;if(console.log("[search]      ",t),t.startsWith("//"))o=!0,t=t.slice(2);else{o=!1;const d=simplify(t);d!==t&&(console.log("[search][norm]",d),t=d)}let l=null,i="includes";if(t.startsWith("/*/")||t.startsWith("/8/")){const p=t.slice("/*/".length),f=p.startsWith("*"),h=p.endsWith("*");f&&h?(i="includes",l=`includes "${t=p.slice(1,-1)}"`):f?(i="endsWith",l=`ends with "${t=p.slice(1)}"`):h?(i="startsWith",l=`starts with "${t=p.slice(0,-1)}"`):(i="===",l=`matches "${t=p}"`)}let c;c=o?"==="===i?(e,t)=>e===t:(e,t)=>e[i](t):"==="===i?(e,t)=>simplify(e)===t:(e,t)=>simplify(e)[i](t);function justSearch(t){return findAll(e,(e=>c(e.name,t)))}if(["https://","http://"].some((e=>t.startsWith(e)))){const v=new URL(t);if("www.youtube.com"===v.hostname&&"/watch"===v.pathname)t=v.searchParams.get("v");else{const m=v.pathname.length>1&&v.pathname.endsWith("/"),g=null==(a=(m?v.pathname.slice(0,-1):v.pathname).match(/[^\/]+$/))?void 0:a[0];if(!g)return{result:[],search:t};const{name:y,ext:b}=(null==(n=g.match(/(?<name>.+)(\.(?<ext>.+))$/))?void 0:n.groups)||{name:g};t=y+(m&&b?`.${b}`:"")}return{result:await justSearch(t),search:t}}const u="\\/s(ize)?(?<defaultPrefix>b|k|m|g|t)?[:\\/]";if(t.match(new RegExp(u))){const w=new RegExp(u+"(?<extra1>(?<caret>\\^)|(?<dollar>\\$)|(?<percent>%))?"+"((?<sizeString1>\\s*\\d[\\d\\s\\,]*)((?<dotDecimal1>\\.(?<decimal1>\\d+)?))?(?<prefix1>b|k|m|g|t)?(?<exclamations>!+)?)"+`(?<range>${"(?<extra2>(?<plus>\\+)|(?<minus>\\-)|(?<tildes>\\~+))"}${"((?<sizeString2>\\s*-?\\s*\\d[\\d\\s\\,]*)((?<dotDecimal2>\\.(?<decimal2>\\d+)?))?(?<prefix2>b|k|m|g|t)?)?"})?`),{defaultPrefix:S,caret:_,dollar:k,percent:D,sizeString1:z,decimal1:T,prefix1:E,exclamations:M,plus:C,minus:x,tildes:I,sizeString2:P,decimal2:j,prefix2:$}=(null==(s=t.match(w))?void 0:s.groups)||{};if(z){let F,L,multiplyByPrefix=function(e,t="b"){if(void 0===e)return;const a=["b","k","m","g","t"];return Math.trunc(e*1024**a.indexOf(t))};console.log({defaultPrefix:S,extra1:{caret:_,dollar:k,percent:D},sizeString1:z,decimal1:T,prefix1:E,exclamations:M,extra2:{plus:C,minus:x,tildes:I,sizeString2:P,decimal2:j,prefix2:$}});let W=Number(z.replaceAll(/[\s,]/g,""));const B=W.toString();let H=P&&Number(P.replaceAll(/[\s,]/g,""));const R=null==H?void 0:H.toString(),N=T?Number("0."+T):0,O=j?Number("0."+j):0;async function rangeSearch(t,a){const{_min:n,max:s}=t<a?{_min:t,max:a}:{_min:a,max:t},r=Math.max(0,n);F=`Size search from ${bytesToSizeWinLike(r)} to ${bytesToSizeWinLike(s)}`,L=await findAll(e,(e=>e.size>=r&&e.size<=s))}if(W=multiplyByPrefix(W+N,E||S),H=multiplyByPrefix(H+O,$||S),_)F=`Size search starts with "${B}"`,L=await findAll(e,(e=>e.size.toString().startsWith(B)));else if(k)F=`Size search ends with "${B}"`,L=await findAll(e,(e=>e.size.toString().endsWith(B)));else if(D)F=`Size search includes "${B}"`,L=await findAll(e,(e=>e.size.toString().includes(B)));else if(C&&R)await rangeSearch(W,W+H);else if(x&&R)await rangeSearch(W,H);else if(I)if(R)await rangeSearch(W-H,W+H);else{const A=I.length,Y=Math.trunc(5*W*A/100);await rangeSearch(W-Y,W+Y)}else{const U=E||S;if(U&&"b"!==U){let q=B.length,Z=multiplyByPrefix(1,U);1===q&&(Z=Math.trunc(Z/10));let G=W-Z,J=W+Z;M&&(G=W,M.length>1&&(J=W+Math.trunc(Z/10))),await rangeSearch(G,J)}else F=`Size search ${bytesToSizeWinLike(W)}`,L=await findAll(e,(e=>e.size===W))}return console.log(...blue(F)),{result:L,search:F}}{const K="No size to search";return console.log(...blue(K)),{result:[],search:K}}}if(t.startsWith("/")){const{type:V,word:X}=(null==(r=t.match(/\/type:(?<type>[^\/]+)\/?(?<word>[^\/]*)/))?void 0:r.groups)||{};if(V&&(console.log({type:V,word:X}),ie.includes(V))){return{result:await findAll(e,(e=>e.type===V&&c(e.name,X))),search:t}}}else if(t.includes(" ")){const Q=t.split(" ").filter((e=>e));if(Q.length>1){let ee,te=await justSearch(Q.shift());for(;ee=Q.shift();)te=te.filter((e=>c(e.name,ee)));return{result:te,search:t}}}return{result:await justSearch(t),search:l||t}}(n,a);if(ge.value=!1,Se.value!==a)return console.log("[return][new search requested]"),performSearch();if(ye.value=!1,!o)return;addMessage(`Search time: ${(performance.now()-s).toFixed(2)} ms; `),await sleep(),setSearchResult(o);appendMessage(`Sort time: ${sortSearch().toFixed(2)} ms; `),await sleep(),console.time("search result size computing");const i=new Set(o),c=o.reduce(((e,t)=>computeEntrySize(t,i)+e),0),u=o.filter((e=>"folder"!==e.type)).reduce(((e,t)=>t.size+e),0);console.timeEnd("search result size computing"),console.log({allSize:c,filesSize:u}),appendMessage(`${o.length} items; size: ${bytesToSizeWinLike(u)} (${bytesToSizeWinLike(c)});  search: ${l}`),e&&(document.title=`[${o.length}] found`)}function computeEntrySize(e,t){if("folder"!==e.type)return e.size;let a=0;for(const n of e.children||[])t.has(n)||("folder"===n.type?a+=computeEntrySize(n,t):a+=n.size);return a}async function findAll(e,t){let a=[],n=Date.now();for(const s of function*(e){const t=1e3;let a=[];function*takePart(e){for(const n of e.children||[])"folder"===n.type&&(yield*takePart(n)),a.push(n),a.length===t&&(yield a,a=[])}yield*takePart(e),yield a}(e)){const e=Date.now();e-n>15&&(n=e,await sleep());for(const n of s)t(n)&&a.push(n)}return a}async function*parseScan(e){const t=new EntryStreamParser;let a,n;if(e instanceof Response?a=e.headers.get("content-type"):e instanceof Blob&&(a=e.type),function(e){return Boolean(e.match(/^application\/.*?gzip/))}(a)){console.log("parseGZippedJSONScan");for await(const a of async function*(e){const t=new TextDecoder,a=new TextParser;let n=0,s=0;for await(const r of async function*(e){ze||await async function(){if(!ze){const e="https://cdn.jsdelivr.net/npm/pako@2.0.4/dist/pako_inflate.min.js",t="sha256-ZIKs3+RZEULSy0dR6c/mke8V9unZm9vuh05TqvtMdGU=";await function(e,t){return new Promise(((a,n)=>{const s=document.createElement("script");s.onload=a,s.onerror=a=>n({message:"Failed to load script",src:e,integrity:t,event:a}),s.src=e,s.async=!0,t&&(s.integrity=t,s.crossOrigin="anonymous"),document.body.append(s)}))}(e,t),ze=!0,console.log("pako is loaded")}}();let t=[];const a=new pako.Inflate;pako.Inflate.prototype.onData=function(e){t.push(e)};for await(const n of iterateAsyncDataSource(e)){a.push(n);for(const e of t)yield e;t=[]}yield a.result,a.err&&console.error(a.msg)}(e)){if(!(n++%20)){const e=Date.now();e-s>15&&(s=e,await sleep())}const e=t.decode(r,{stream:!0}),o=a.parsePart(e);o.length&&(yield o)}}(e))n||(n=a.shift(),t.setMeta(n)),yield{meta:n,...t.parse(a)}}else if(function(e){return Boolean(e.match(/^application\/.*?json/))}(a)){console.log("streamParseJSONScan");for await(const a of async function*(e){const t=new TextDecoder,a=new TextParser;let n=0,s=0;for await(const r of iterateAsyncDataSource(e)){if(!(n++%10)){const e=Date.now();e-s>15&&(s=e,await sleep())}const e=t.decode(r,{stream:!0}),o=a.parsePart(e);o.length&&(yield o)}}(e))n||(n=a.shift(),t.setMeta(n)),yield{meta:n,...t.parse(a)}}t.processHIDMapAsync()}c(Se,(async(e,t)=>{if(!e)setSearchResult([]);else if(ye.value=!0,e.length-t.length>1){if(e.startsWith("https://mega.nz/"))return void(await handleMegaUrl(e));await performSearch()}else await De()}));class TextParser{constructor(){__publicField(this,"buffer",""),__publicField(this,"startHandled",!1),__publicField(this,"metaLines",[]),__publicField(this,"objects",[])}trimComma(e){return e.endsWith(",")?e.slice(0,-1):e}handleStart(e){if("["!==e)return""===e?(this.objects.push(this.metaLines.join("")),void(this.startHandled=!0)):void this.metaLines.push(e)}handleLine(e,t){t?this.buffer+=e:this.buffer?(this.objects.push(this.buffer+e),this.buffer=""):this.objects.push(e)}parsePart(e){const t=e.endsWith("\n]"),a=e.split("\n");for(let s=0;s<a.length;s++){const e=a[s],n=s===a.length-1;n&&t||(this.startHandled?this.handleLine(e,n):this.handleStart(e,n))}try{const e=JSON.parse(`[${this.trimComma(this.objects.join(""))}]`);return this.objects=[],e}catch(n){throw console.log(`[${this.trimComma(this.objects.join(""))}]`),console.log(this.objects),console.log(this,{isLastPart:t,textPart:e}),n}}}let ze=!1;const Te=i(null),Ee=i(null),Me=p(Te);p(Ee);const Ce=i(new class extends SimpleEntry{constructor({name:e}={name:""}){super({name:e,type:"folder",pid:null},null),this.addMeta({})}get size(){return this.children.reduce(((e,t)=>e+t.size),0)}});globalThis.home=Ce.value;const xe=a(!1);function clearHome(){console.log("clearHome"),clearSearch(),openFolder(ce),Ee.value=null,Te.value=null,globalThis.root=null,globalThis.folder=null,Ce.value.children=[],u(Le)}const Ie=p(Ce),Pe=l(xe);function updateParsingState(){u(Le)}const je=new class{constructor(){this.abortRequested=!1,this._promise=Promise.resolve(),this._resolve=()=>{}}abort(){return this.abortRequested=!0,this._promise}start(){this._promise=new Promise((e=>this._resolve=e))}abortIfRequested(){return!!je.abortRequested&&(this.abortRequested=!1,this._resolve(),!0)}};async function setScan(e,t=!1){pe.value&&await je.abort(),me.value=0,pe.value=!0,je.start();let a=!1,n=!1;const s=Date.now();let r,o=Date.now(),l=0;for await(const{meta:i,root:c,rootUpdated:u,processed:d}of parseScan(e)){if(l+=d,r){const e=(l/r*100).toPrecision(3);me.value=Number(e)}if(je.abortIfRequested())return console.log("[setScan][time][aborted]",Date.now()-s,"ms"),!1;!n&&c&&(!a&&i&&(c.meta=i,a=!0,r=i.total,l-=1),openFolder(c,t),n=!0);const e=Date.now();(u||e-o>50)&&(o=e,updateParsingState(),await sleep())}return updateParsingState(),console.log("[setScan][time]:",Date.now()-s,"ms"),pe.value=!1,!0}const $e=n((()=>{var e;return(null==(e=Te.value)?void 0:e.separator)||"/"})),Fe=n((()=>{var e;return(null==(e=Te.value)?void 0:e.path)||[]})),Le=i(ce),We=n((()=>Le.value.path));function openFolder(e,t=!1){var a;t||clearSearch(),Le.value=e,ae.value=50;const n=e.root;globalThis.root=n,n.value=n,Te.value=n.meta||{},e!==Ce.value&&((null==(a=Ce.value.children)?void 0:a.includes(n))||(Ce.value.addChild(n),u(Ce))),xe.value=e===Ce.value,globalThis.folder=e,console.log("globalThis.folder:",e)}Object.defineProperty(globalThis,"flat",{get(){var e;return null==(e=globalThis.folder)?void 0:e.flat()}});const Be=n((()=>Ee.value&&Le.value.isEmpty));c(Te,(async(e,t)=>{if(console.log("[meta]:",Te.value),!Te.value)return;const{files:a,folders:n,symlinks:s,errors:r,total:o,scanDate:l}=Te.value;Te.value.scanDate&&addMessage(`files: "${a}" folders: "${n}", symlinks: "${s}", errors: "${r}", total: "${o}", scanDate: "${dateToDayDateString(l)}"`)}));const _export_sfc=(e,t)=>{const a=e.__vccOpts||e;for(const[n,s]of t)a[n]=s;return a},He={class:"scanPath"},Re=["title"],Ne={class:"part"},Oe={class:"part spaced"},Ae={key:0,class:"spaced separator"},Ye=_export_sfc({__name:"AddressBar_Base",setup(e){const t=n((()=>{if(!Me.value)return;const{files:e,folders:t,symlinks:a,charDevs:n,blockDevs:s,fifos:r,sockets:o,total:l,platform:i,scanDate:c}=Me.value;function doString(e){return Object.entries(e).filter((([e,t])=>void 0!==t)).map((([e,t])=>function(e){const t=3-Math.trunc(e.length/4);return e+"\t".repeat(t)}(e)+": "+t)).join("\n")}const u=doString({files:e,folders:t,symlinks:a}),d=doString({charDevs:n,blockDevs:s,fifos:r,sockets:o}),p=doString({total:l,platform:i,scanDate:c?dateToDayDateString(c):void 0}),f=doString(Me.value.special||{});let h;return h="win32"!==i?[u,d,p,f].filter((e=>e)).join("\n"):[u,p,f].filter((e=>e)).join("\n"),console.log(h),h})),a=n((()=>{var e;const t=[...Fe.value,Le.value.root.name].join($e.value);return t.startsWith("//")?t.slice(1):"win32"===(null==(e=Me.value)?void 0:e.platform)?t[0].toUpperCase()+t.slice(1):t})),s=n((()=>[...a.value].slice(0,-1).join(""))),r=n((()=>[...a.value].slice(-1).join(""))),o=n((()=>We.value.length-1&&"/"!==a.value));function goToRoot(){const e=Le.value.root;debugMessageFromEntry(e),openFolder(e)}return(e,a)=>(f(),h("span",He,[v("span",{class:"parts",onClick:goToRoot,title:g(t)},[v("span",Ne,m(g(s)),1),v("span",Oe,m(g(r)),1)],8,Re),g(o)?(f(),h("span",Ae,m(g($e)),1)):y("",!0)]))}},[["__scopeId","data-v-c7e0debc"]]),Ue={class:"opened-folder"},qe={class:"part"},Ze={class:"part spaced"},Ge={key:0,class:"separator spaced"},Je=_export_sfc({__name:"AddressBar_Folder",props:["index","count","entry"],setup(e){const t=e,{index:a,count:s,entry:r}=b(t),o=n((()=>a.value+1===s.value)),l=n((()=>[...r.value.name].slice(0,-1).join(""))),i=n((()=>[...r.value.name].slice(-1).join("")));function onClick(){debugMessageFromEntry(r.value),openFolder(r.value)}return(e,t)=>(f(),h("span",Ue,[v("span",{class:"parts",onClick:onClick},[v("span",qe,m(g(l)),1),v("span",Ze,m(g(i)),1)]),g(o)?y("",!0):(f(),h("span",Ge,m(g($e)),1))]))}},[["__scopeId","data-v-ab2cb264"]]),Ke={class:"box"},Ve=_export_sfc({__name:"AddressBar_Part",props:{maxWidth:{default:"max-content",type:String}},setup:e=>(t,a)=>(f(),h("div",Ke,[v("div",{class:"sub",style:S({maxWidth:e.maxWidth})},[w(t.$slots,"default",{},void 0,!0)],4)]))},[["__scopeId","data-v-9d685040"]]),Xe=_export_sfc({__name:"AddressBar",setup(e){async function onContextmenu(e){e.preventDefault();const t=[...Me.value.path,...Le.value.path.map((e=>e.name))].join($e.value);console.log("Copy to clipboard:",t),await navigator.clipboard.writeText(t)}return(e,t)=>(f(),h("div",{class:"address",onContextmenu:onContextmenu},[_(Ve,null,{default:k((()=>[_(Ye)])),_:1}),(f(!0),h(D,null,z(g(We).slice(1),((e,t)=>(f(),T(Ve,null,{default:k((()=>[_(Je,{entry:e,index:t,count:g(We).slice(1).length},null,8,["entry","index","count"])])),_:2},1024)))),256))],32))}},[["__scopeId","data-v-62bab457"]]),Qe={class:"search-wrapper"},et={class:"search"},tt=["onContextmenu"],at=(e=>(j("data-v-847e7c62"),e=e(),$(),e))((()=>v("label",{for:"json-scan-search-input",class:"fuck-off-lighthouse"},".",-1))),nt=_export_sfc({__name:"Search",setup(e){const t=a();function onClearClick(){clearSearch(),t.value.focus()}async function onContextMenu(){try{const e=await navigator.clipboard.readText();console.log("[clipboard] readText:",e),Se.value=e}catch(e){console.error("[clipboard] read failed",e)}}let n=0;function doubleShiftHandler(e){if("Shift"!==e.key)return;const a=Date.now();a-n<250?t.value.focus():n=a}return E((()=>document.addEventListener("keydown",doubleShiftHandler))),M((()=>document.removeEventListener("keydown",doubleShiftHandler))),(e,a)=>(f(),h("div",Qe,[v("div",et,[C(v("input",{id:"json-scan-search-input",type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>I(Se)?Se.value=e:null),ref_key:"inputRef",ref:t},null,512),[[x,g(Se)]]),v("button",{onClick:onClearClick,onContextmenu:P(onContextMenu,["prevent"]),title:"Right click to clear and paste"},"Clear",40,tt)]),at]))}},[["__scopeId","data-v-847e7c62"]]),st={class:"default-hover-text"},rt=_export_sfc(F({__name:"FileInputDefaultHoverText",props:{state:null},setup(e){const t=e,{dropHoverItemCount:a}=t.state.private,s=n((()=>{const e=a.value>1?"s":"";return`Drop ${a.value} file${e}`}));return(e,t)=>(f(),h("div",st,m(g(s)),1))}}),[["__scopeId","data-v-4b9b1e9d"]]),ot=["title"],lt={key:0,class:"parsing"},it={key:1},ct={key:2,style:{display:"contents"}},ut=_export_sfc(F({__name:"FileInputDefaultText",props:{state:null},setup(e){const t=e,{count:a,fileEntries:s,parsing:r}=t.state.private,o=n((()=>s.value.slice(0,50).map((e=>e.name)).join("\n")));return(e,t)=>(f(),h("div",{class:"default-prompt-text",title:g(o)},[g(r)?(f(),h("div",lt,"Parsing...")):g(a)?(f(),h("div",it,m(g(a))+" file"+m(g(a)>1?"s":""),1)):(f(),h("div",ct,[w(e.$slots,"default",{},(()=>[L("Select file")]),!0)]))],8,ot))}}),[["__scopeId","data-v-ae43ba01"]]),dt=["accept","multiple","nwdirectory"],pt={key:0,class:"content hover"},ft={key:1,class:"content selected"},ht={key:2,class:"content prompt"},vt=_export_sfc(F({__name:"FileInput",props:{globalDropZone:{type:Boolean,default:!0},dropZoneSelector:{type:String},accept:{type:String,default:"*/*"},multiple:{type:Boolean,default:!0},state:{type:Object,required:!0},nwdirectory:{type:Boolean,default:!1}},setup(e){const t=e,s=a(null),{globalDropZone:r,dropZoneSelector:l,nwdirectory:i}=b(t),{parsing:c,file:u,dropHover:d,setFiles:p,setDataTransfer:m,setDataTransferHover:y,resetDataTransferHover:S,isNwDirectory:k,inputElem:D}=t.state.private;function onFileInputChange(e){const t=e.target;p(t.files)}o((()=>{k.value=i.value})),o((()=>{D.value=s.value}));const z=a(null),M=n((()=>l.value?document.querySelector(l.value):r.value?document.body:z.value));function stopEvent(e){e.preventDefault(),e.stopPropagation()}function onDrop(e){stopEvent(e),d.value=!1,m(e.dataTransfer)}function onDragOver(e){stopEvent(e),e.dataTransfer.dropEffect="copy"}function onDragEnter(e){stopEvent(e),d.value||(d.value=!0,y(e.dataTransfer))}function onDragLeave(e){stopEvent(e),M.value.contains(e.relatedTarget)||(d.value=!1,S())}function dragOverCallback(e){M.value.contains(e.target)||(stopEvent(e),e.dataTransfer.dropEffect="none")}function onKeyDown(e){"Enter"===e.key&&z.value.querySelector("label").click()}return E((()=>{M.value.addEventListener("drop",onDrop),M.value.addEventListener("dragover",onDragOver),M.value.addEventListener("dragleave",onDragLeave),M.value.addEventListener("dragenter",onDragEnter),document.body.addEventListener("dragover",dragOverCallback)})),W((()=>{M.value.removeEventListener("drop",onDrop),M.value.removeEventListener("dragover",onDragOver),M.value.removeEventListener("dragleave",onDragLeave),M.value.removeEventListener("dragenter",onDragEnter),document.body.removeEventListener("dragover",dragOverCallback)})),(t,a)=>(f(),h("div",{class:B(["file-input",{"drop-hover":g(d)}]),ref_key:"fileInputElem",ref:z,tabindex:"0",onKeydown:onKeyDown},[v("label",null,[v("input",{type:"file",accept:e.accept,multiple:e.multiple,onChange:onFileInputChange,style:{display:"none"},nwdirectory:g(i),ref_key:"templateInputElem",ref:s},null,40,dt),g(d)?(f(),h("span",pt,[w(t.$slots,"hover",{},(()=>[_(rt,{state:e.state},null,8,["state"])]),!0)])):g(u)&&!g(c)?(f(),h("span",ft,[w(t.$slots,"selected",{},(()=>[_(ut,{state:e.state},null,8,["state"])]),!0)])):(f(),h("span",ht,[w(t.$slots,"prompt",{},(()=>[_(ut,{state:e.state},null,8,["state"])]),!0)]))]),(f(),T(H,{to:"body"},[v("div",{class:B(["file-input-hover-modal",{"drop-hover":g(d)}])},null,2)]))],34))}}),[["__scopeId","data-v-f1699920"]]),mt=be.fileEntries;c(mt,(async()=>{clearHome(),fe.value=!1,he.value=mt.value.length,ve.value=0;for(const e of mt.value)ve.value++,await setScan(e.file,!0);mt.value.length>1&&(openFolder(Ie.value,!0),debugMessageFromEntry(Ie.value)),fe.value=!0}));const gt={class:"file-input-wrapper"},yt=_export_sfc({__name:"FileInputWrapper",setup:e=>(e,t)=>(f(),h("div",gt,[_(vt,{accept:"application/json,application/gzip",multiple:!0,state:g(be)},null,8,["state"])]))},[["__scopeId","data-v-817e62b1"]]),bt=_export_sfc({__name:"Home",setup(e){const t=n((()=>{var e,t;return(null==(t=null==(e=Ie.value)?void 0:e.children)?void 0:t.length)>1}));function onClick(){debugMessageFromEntry(Ie.value),openFolder(Ie.value)}function onContextMenu(e){e.preventDefault(),clearHome()}return(e,a)=>g(t)?(f(),h("div",{key:0,class:B(["home",{active:g(Pe)}]),onClick:onClick,onContextmenu:onContextMenu}," Home ",34)):y("",!0)}},[["__scopeId","data-v-13363939"]]),wt={class:"tabs"},St=_export_sfc({__name:"Tabs",setup:e=>(e,t)=>(f(),h("div",wt,[_(yt,{class:"tab"}),_(bt,{class:"tab"})]))},[["__scopeId","data-v-4fd86931"]]),_t=["title"],kt={class:"icon"},Dt=["title"],zt=["title"],Tt=_export_sfc({__name:"Row",props:["entry"],setup(e){const t=b(e).entry,s=n((()=>t.value.hasErrors?"":bytesToSizeWinLike(t.value.size))),r=n((()=>"0 B"===s.value?"Z":s.value.split(" ")[1])),l=n((()=>t.value.hasErrors)),i=n((()=>{if(void 0===t.value[K.value])return"";return dateToDayDateTimeString(t.value[K.value],!1).slice(0,-3)})),c=n((()=>t.value.hasErrors?JSON.stringify(t.value.errors[0],null," "):"symlink"===t.value.type?t.value.pathTo:void 0)),u=n((()=>{const e=t.value.type;if("folder"===e)return"📁";if("file"===e){const e=t.value.name;return function(e){const{ext:t}=e.match(/(?<ext>[^.]+)$/).groups;return q.includes(t.toLowerCase())}(e)?"🎦":function(e){const{ext:t}=e.match(/(?<ext>[^.]+)$/).groups;return Z.includes(t.toLowerCase())}(e)?"🖼":function(e){const{ext:t}=e.match(/(?<ext>[^.]+)$/).groups;return G.includes(t.toLowerCase())}(e)?"🎵":"📄"}return"symlink"===e?"🔗":"👾"}));function onClick(e){debugMessageFromEntry(t.value),globalThis.c=globalThis.clicked=t.value,"folder"===t.value.type&&openFolder(t.value)}function onMousedown(e){1===e.button&&(e.preventDefault(),console.log(t.value.getPathString(t.value.root.meta),t.value),Le.value!==t.value.parent&&openFolder(t.value.parent))}function onMouseover(e){oe.value=t.value}function onMouseleave(e){oe.value=null}const d=a(!1);return o((()=>{var e,a;if("symlink"===(null==(e=oe.value)?void 0:e.type)){const e=oe.value.pathTo,a=t.value.getPathString(t.value.root.meta);return void(d.value=e===a)}const n=!(null==(a=oe.value)?void 0:a.hardlinks);d.value&&n&&(d.value=!1),n||(d.value=oe.value.hardlinks.includes(t.value))})),(e,a)=>(f(),h("tr",{class:B(["row",{error:g(l),hoveredLink:d.value}]),onClick:onClick,onMousedown:onMousedown,onMouseover:onMouseover,onMouseleave:onMouseleave,title:g(c)},[v("td",kt,m(g(u)),1),v("td",{class:"name",title:g(t).getPathString(g(t).root.meta)},m(g(t).name),9,Dt),v("td",{class:B(["size",g(r)]),title:g(tripleSizeGroups)(g(t).size)},m(g(s)),11,zt),v("td",{class:B(["time",{[g(K)]:!0}])},m(g(i)),3)],42,_t))}},[["__scopeId","data-v-261ad697"]]),Et=_export_sfc({__name:"IntersectionRow",setup(e){const t=new IntersectionObserver((e=>{const[t]=e;t.isIntersecting&&re.value>ae.value&&(ae.value=ae.value+50)})),n=a(null);return E((()=>{t.observe(n.value)})),W((()=>{t.disconnect()})),(e,t)=>(f(),h("div",{class:"intersection",ref_key:"intersection",ref:n},null,512))}},[["__scopeId","data-v-91b58eda"]]),_withScopeId$3=e=>(j("data-v-130e4501"),e=e(),$(),e),Mt={key:0,class:"rows"},Ct={key:1,class:"empty-message"},xt=[_withScopeId$3((()=>v("span",null,"The folder is empty.",-1)))],It={key:2,class:"error-message"},Pt=_withScopeId$3((()=>v("h2",null,"Error",-1))),jt=_withScopeId$3((()=>v("td",null,"syscall",-1))),$t=_withScopeId$3((()=>v("td",null,"code",-1))),Ft=_withScopeId$3((()=>v("td",null,"errno",-1))),Lt=_export_sfc({__name:"Content",setup(e){R((e=>({"737856fd":s.value})));const t=n((()=>!!Le.value.hasErrors&&Le.value.errors[0]));function onContextMenu(e){e.preventDefault(),Le.value.parent&&openFolder(Le.value.parent)}const s=a();function resizeNameElem(){const e=document.body.offsetWidth;if(e<1280){let t=893-(1280-e)+(e<=720?113:0);t=t<140?140:t,s.value=`${t}px`}else s.value="893px"}return E((()=>{resizeNameElem(),window.addEventListener("resize",resizeNameElem)})),N((()=>{window.removeEventListener("resize",resizeNameElem)})),(e,a)=>(f(),h("div",{class:"content",onContextmenu:onContextMenu},[g(se).length?(f(),h("table",Mt,[v("tbody",null,[(f(!0),h(D,null,z(g(se),(e=>(f(),T(Tt,{entry:e,key:`${e.pathString}//${e.size}`},null,8,["entry"])))),128)),_(Et)])])):y("",!0),g(Be)&&!g(t)?(f(),h("div",Ct,xt)):y("",!0),g(t)?(f(),h("div",It,[v("div",null,[Pt,v("table",null,[v("tbody",null,[v("tr",null,[jt,v("td",null,[v("pre",null,m(g(t).syscall),1)])]),v("tr",null,[$t,v("td",null,[v("pre",null,m(g(t).code),1)])]),v("tr",null,[Ft,v("td",null,[v("pre",null,m(g(t).errno),1)])])])])])])):y("",!0)],32))}},[["__scopeId","data-v-130e4501"]]),Wt={class:"status"},Bt=_export_sfc({__name:"Status",setup(e){const t=n((()=>{var e;return(null==(e=oe.value)?void 0:e.size)&&bytesToSizeWinLike(oe.value.size)}));return(e,a)=>(f(),h("div",Wt,[v("span",null,"Items count: "+m(g(re)),1),C(v("span",null,". Hover item's size: "+m(g(t)),513),[[O,g(oe)]])]))}},[["__scopeId","data-v-f9068cda"]]),Ht={class:"switch"},Rt=["title","onContextmenu"],Nt=_export_sfc({__name:"Switch",setup(e){function toggleTimeType(){K.value="mtime"===K.value?"btime":"mtime"}function onClick(e){V.value===e&&toggleOrder(),V.value=e}return(e,t)=>(f(),h("div",Ht,[v("button",{class:B(["order-by-name",{active:"name"===g(V)}]),title:"Order by name",onClick:t[0]||(t[0]=e=>onClick("name"))},m(g(X).name?"N":"n"),3),v("button",{class:B(["order-by-size",{active:"size"===g(V)}]),title:"Order by size",onClick:t[1]||(t[1]=e=>onClick("size"))},m(g(X).size?"S":"s"),3),v("button",{class:B(["order-by-time",{active:"time"===g(V),[g(K)]:!0}]),title:"Order by "+g(K),onClick:t[2]||(t[2]=e=>onClick("time")),onContextmenu:P(toggleTimeType,["prevent"])},m(g(X).time?"D":"d"),43,Rt)]))}},[["__scopeId","data-v-bae25d80"]]),Ot={class:"debug"},At=_export_sfc({__name:"Debug",setup:e=>(e,t)=>(f(),h("div",Ot,[v("span",null,m(g(le)),1)]))},[["__scopeId","data-v-74baf769"]]),Yt={},Ut={class:"guide"},qt=[A('<div class="text-wrapper" data-v-46aec482><h2 data-v-46aec482>No scan selected</h2><div data-v-46aec482>Use your own directory scan file (created with <a href="https://github.com/AlttiRi/keep-lister#how-to-use" target="_blank" data-v-46aec482>the scanner</a>). </div><div class="" data-v-46aec482>Or use the demo scans to take a look at the program&#39;s work <span class="gray" data-v-46aec482>(just click on the link)</span>: <ul data-v-46aec482><li data-v-46aec482><a href="./?filepath=https://alttiri.github.io/json-flat-scans/windows-admin.json.gz" data-v-46aec482>Win 10 scan (as Admin)</a></li><li data-v-46aec482><a href="./?filepath=https://alttiri.github.io/json-flat-scans/ubuntu-admin.json.gz" data-v-46aec482>Ubuntu scan (as Root)</a></li><li data-v-46aec482><a href="./?filepath=https://alttiri.github.io/json-flat-scans/linux-master.json.gz" data-v-46aec482>Linux Source Code scan</a></li></ul></div><div class="gray" data-v-46aec482>Also it supports mega.nz folder links (https://mega.nz/folder/ABcd12#XXX).<br data-v-46aec482> Just paste them in the search field.</div><div data-v-46aec482>For more info see the <a href="https://github.com/AlttiRi/keep-lister#keeplister" target="_blank" data-v-46aec482>Readme</a>.</div></div>',1)];const Zt=_export_sfc(Yt,[["render",function(e,t){return f(),h("div",Ut,qt)}],["__scopeId","data-v-46aec482"]]),Gt={class:"inner-modal"};const Jt=_export_sfc({},[["render",function(e,t){return f(),h("div",Gt,[w(e.$slots,"default",{},void 0,!0)])}],["__scopeId","data-v-6b3a99be"]]),Kt=["title"],Vt=(e=>(j("data-v-f8d1ea96"),e=e(),$(),e))((()=>v("div",{class:"invisible"},null,-1))),Xt=_export_sfc({__name:"MemoryConsuming",setup(e){const t=a(performance.memory),s=n((()=>t.value.jsHeapSizeLimit)),r=n((()=>t.value.totalJSHeapSize));n((()=>t.value.usedJSHeapSize));const o=a(null),l=a(!1),i=a(!1),c=n((()=>{const e=r.value/(s.value/100);return l.value=e>100,l.value?100:e})),u=n((()=>bytesToSizeWinLike(r.value))),d=n((()=>t.value));function onMousedown(e){0===e.button&&(i.value=!0),1===e.button&&(e.preventDefault(),i.value=!1,console.clear())}return E((()=>{d.value&&(o.value=setInterval((()=>{t.value=performance.memory}),1e3))})),W((()=>{o.value&&clearInterval(o.value)})),(e,t)=>g(d)?(f(),h("div",{key:0,class:"memory-consuming-component",style:S({width:g(c)+"%"}),title:"Heap size: "+g(u)+(i.value?"\nUse middle mouse button click to clear the console.":""),onMousedown:onMousedown},[v("div",{class:B(["visible",{over100:l.value}])},null,2),Vt],44,Kt)):y("",!0)}},[["__scopeId","data-v-f8d1ea96"]]),Qt=[(e=>(j("data-v-803fb0d2"),e=e(),$(),e))((()=>v("div",{class:"visible"},null,-1)))],ea=_export_sfc({__name:"ScanProgressBar",setup(e){const t=a(!1);return o((async()=>{100===me.value&&(t.value=!0,await sleep(16),t.value=!1)})),(e,a)=>g(pe)||t.value?(f(),h("div",{key:0,class:"scan-parsing-progress-component",style:S({width:g(me)+"%"})},Qt,4)):y("",!0)}},[["__scopeId","data-v-803fb0d2"]]),ta={class:"main"},aa=(e=>(j("data-v-ae447501"),e=e(),$(),e))((()=>v("a",{class:"readme",title:"Open Readme",href:"https://github.com/AlttiRi/keep-lister#keeplister",target:"_blank"},[v("i",null,"i")],-1))),na=_export_sfc({__name:"Main",setup(e){globalThis.bytesToSize=bytesToSize,globalThis.bytesToSizeWinLike=bytesToSizeWinLike;const t=n((()=>void 0===Me.value&&!new URL(location.href).searchParams.get("filepath")||null===Me.value));return E((async()=>{const e=new URL(location.href),t=e.searchParams.get("filepath"),a=e.searchParams.get("sort")||e.searchParams.get("order");if(["name","size","time"].includes(a)&&(V.value=a,["true","1"].includes(e.searchParams.get("desc"))&&toggleOrder()),t){const e=await fetch(t);await setScan(e)}const n=e.hash.slice(1);n.startsWith("https://mega.nz/")&&await handleMegaUrl(n);const s=e.searchParams.get("search");s&&(Se.value=s)})),(e,a)=>(f(),h("div",ta,[_(Xt),_(ea),_(Nt,{style:{"grid-area":"switch"}}),_(Xe,{style:{"grid-area":"address"}}),_(nt,{style:{"grid-area":"search"}}),_(St,{style:{"grid-area":"tabs"}}),g(t)?(f(),T(Zt,{key:0,style:{"grid-area":"content"}})):g(pe)&&g(ye)?(f(),T(Jt,{key:1,style:{"grid-area":"content"}},{default:k((()=>[L(" [Search]: Scan parsing awaiting ("+m(g(ve))+" of "+m(g(he))+") ",1)])),_:1})):(f(),T(Lt,{key:2,style:{"grid-area":"content"}})),_(Bt,{style:{"grid-area":"status"}}),_(At,{style:{"grid-area":"debug"}}),aa]))}},[["__scopeId","data-v-ae447501"]]);Y({__name:"App",setup:e=>(e,t)=>(f(),T(na))}).mount("#app");
//# sourceMappingURL=index.js.map
